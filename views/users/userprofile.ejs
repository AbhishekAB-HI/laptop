<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User profile</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/userprofile.css"> 
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/productpage.css">
</head>
<body>


     <!-- head -->
<nav style="background-color: rgb(65 62 62);" class="navbar navbar-expand-lg navbar-light fixed-top mb-5">
  <div class="container px-4 px-lg-5">
    <div ><p class="logo" style="font-size: 24px;" >TrendHub</p> </div>
    <nav class="navbar navbar-expand-lg navbar-light ">
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse " id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link text-white" href="/dashboard">Home <span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle text-white" href="#" id="navbarDropdown" role="button"
              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Account
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="/aboutus">My profile</a>
              <a class="dropdown-item" href="/logout">logout</a>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled text-white" href="">Contact Us</a>

          </li>
          <li class="nav-item">

            <a class="nav-link  text-white" href="/wishlist">Whishlist</a>
          </li>
        </ul>
      </div>
    </nav>
    <form class="d-flex">
      <button class="btn btn-outline-dark text-white" type="submit">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
          class="bi bi-cart3 text-white" viewBox="0 0 16 16">
          <path
            d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .49.598l-1 5a.5.5 0 0 1-.465.401l-9.397.472L4.415 11H13a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l.84 4.479 9.144-.459L13.89 4H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2" />
        </svg>
        <a class="text-white" style="text-decoration: none;border-width: 5px; " href="/getProduct">My cart</a>
      </button>
    </form>
  </div>
  </div>
</nav>

<!-- head -->




<!-- main body -->

    <div class="container-fluid mt-5 ">
        <div class="row">
          <div style="background-color:  rgb(78, 74, 74);" class="profile-nav  col-md-2  p-2  ">
              <div class="panel">
                  <div class="user-heading round">
                      <a class="mb-3" href="#">
                          <img src="/productImages/<%=user.images%>" alt="">
                      </a>
                      <div  style="margin-bottom: 10px;"  >
                      <h5> <%=user.username%></h5>
                      <p><%=user.email%></p>
                    </div>  
                  </div>
                  <div class="profileMenu"  >
                  <ul class="nav nav-pills nav-stacked">
                      <li><a href="/editprofile"> <i class="fa fa-edit"></i> Edit profile</a></li>   
                  </ul>
                  <ul class="nav nav-pills nav-stacked">
                    <li><a href="/addadress"><i class="fa fa-edit"></i> Add address</a></li>                 
                </ul>
                <ul class="nav nav-pills nav-stacked">
                  <li><a href="/changepassword"><i class="fa fa-edit"></i>Change password</a></li>       
              </ul>
              <ul class="nav nav-pills nav-stacked">
                <li><a href="/wallets"><i class="fa fa-edit"></i>wallets</a></li>       
            </ul>
          </div>


            </ul>
              </div>
          </div>

          <div class="profile-info col-md-10   p-1 ">
              <div class="panel">
                  <div class="bio-graph-heading">
                    <h4 class="text-white">Welcome,<%=user.username%></h4>
                  </div>
                  <div class="panel-body bio-graph-info">
                      
                      <div class="row ">
                          <div class="ml-5 mb-2 " >
                            <h1 style="color:rgb(78, 74, 74);font-size: 25px;font-weight: 600;" class="p-2">User details</h1>
                          <div class="bio-row">
                              <p><span>Name</span><%=user.username%></p>
                          </div>
                     
                          <div class="bio-row">
                              <p><span>Email </span><%=user.email%></p>
                          </div>
                          <div class="bio-row">
                              <p><span>Mobile </span><%=user.number%></p>
                              <input style="width: 280px; height: 30px;" type="text" id="codeInput" value='http://localhost:7000/register?code=<%=user.referalId%>' readonly>

                            <button class="p-1" style="background-color: black;color: white;border-radius: 5px;"  onclick="copyCode()">Copy Code</button>
                             
                            
                          </div>
                          <div class="bio-row">
                              <p><span>address </span><%=user.address%></p>
                              
                              
                          </div>
                          <div class="bio-row">
                            
                            <div>
                             
                          </div>
                        </div>
                      </div>
                        <br>
                   
                          
                          

                        <table  class="table bg-light " >
                          <h1 class="ml-5" style="color:rgb(78, 74, 74);font-size: 25px;font-weight: 600;" >Address Info</h1>
                            <thead>
                              <tr>
                                <th scope="col">No</th>
                                <th scope="col">FirstName</th>
                                <th scope="col">LastName</th>
                                <th scope="col">City</th>
                                <th scope="col">Address</th>
                                <th scope="col">Edit-Address</th>
                                <th scope="col">State</th>
                                <th scope="col">Delete</th>
                              </tr>
                            </thead>
                            <tbody>
                                
       <%
      if(address.address1.length>0){
       address.address1.forEach((item,i)=>{
           %>
       <tr>
      <th scope="row"><%=i+1%></th>
      <td><%=item.firstName%></td>
      <td><%=item.lastName%></td>
      <td><%=item.city%></td>
      <td><%=item.address%></td>
      <td> <button class="p-1" style="background-color: black;color: white;border-radius: 5px;"   ><a style="text-decoration: none;color: white;" href="/editAddress?id=<%=item._id%>">Edit</a></button></td>
      <td><%=item.state%></td>
      <td><button class="p-1" style="background-color: black;color: white;border-radius: 5px;"   ><a  style="text-decoration: none;color: white;"  href="/deleteaddress?id=<%=item._id%>">Delete</a></button></td>
  
    </tr>
    
    


          
           <%
       })

      }else{
        %>
        <td><h5 style="color: red;" >No address added</h5></td>
      
        <%
      }



       
       %>
      
    
      
      
                            </tbody>
                          </table>
                          <h1 class="ml-5"  style="color:rgb(78, 74, 74);font-size: 25px;font-weight: 600;" >Show Orderlist</h1>


                          <table class="table bg-light">
                            <thead>
                              <tr>
                              
                                <th scope="col">ProductsImages</th>
                                <th scope="col">Products</th>
                                <th scope="col">Price</th>
                                <th scope="col">Quantity</th>
                                <th scope="col">Sub-Total</th>
                                <th scope="col">CancelOrder</th>
                                <th scope="col">Status</th>
                                <th scope="col">Orderdetailpage</th>
                                <th scope="col">View and downloadinvoice</th>

                              </tr>
                            </thead>
                            <tbody>
                                
       <%

       if(userCart.length>0){
       userCart.forEach((item,i)=>{
           %>

           <%item.products.forEach((value)=>{%>
            
       <tr>

        <td> <img src="/productImages/<%=value.product_id?.images[1]%>" width="50px" height="50px" alt="Blue Jeans Jacket" /></td>
        <td><%=value.product_id.productname%></td>
        <td><%=value.price%></td>
        <td><%=value.qty%></td>
        <td><%=value.totalPrice%></td>
         <input type="hidden" value="<%=item._id%>" >
        <%if(value.status!=="canceled"){%>
          <td><button class="p-1" style="background-color: black;color: white;border-radius: 5px;"   ><a  style="text-decoration: none;color: white;"   href="/deleteorderproduct?id=<%=value._id %>&&orderid=<%=item._id%>&&deleteproductid=<%=value.product_id._id%>">Cancel</a></button></td>
          <%}else{
            %>
            <td><h6 style="color: red;">canceled</h6></td>
            <%
          }%>

<!-- 
          <%if(value.status!=="return"){%>
       
            <td><a href="/returnorderproduct?id=<%=value._id %>&&orderid=<%=item._id%>&&deleteproductid=<%=value.product_id._id%>">return</a></td>
            <%}else{
              %>
              <td><p style="color: red;">Requested</p></td>
              <%
            }%> -->
     
            <td> <strong  style="color: rgb(4, 75, 197);" ><h5><%=value.status%></h5></strong></td>
        
        <td><button style="background-color: green;border-radius: 5px;" ><a style="text-decoration: none;color: white;" href="/detailview?orderid=<%=item._id%>&&productid=<%=value._id%>&&payment=<%=user.payment%>&&deleteproductid=<%=value.product_id._id%>">Viewpage</a></button></td>


        <% if(value.status === 'delivered') { %>
          <td>
            <button style="background-color: rgb(27, 155, 214); border-radius: 5px;">
              <a style="text-decoration: none; color: white;" href="/detailInvoice?orderid=<%=item._id%>&&productid=<%=value._id%>&&payment=<%=user.payment%>&&deleteproductid=<%=value.product_id._id%>">
                View Invoice
              </a>
            </button>
          </td>
        <% } else { %>
          <td>
            <button disabled style="background-color: rgb(207, 214, 217); border-radius: 5px;">
              
                View Invoice
              
            </button>
          </td>
        <% } %>


        
      </tr> 
            <%})%>          
           <%
       })

       }else{
        %>
        <td><h3 style="color: red;">No orders</h3></td>
        
        <%
       }
       %>
      
      
    
    
      
                            </tbody>
                          </table>

                      </div>
                  </div>
              </div>

      

          </div>
        </div>
        </div>
        <div class="text-center  ">
     
          <%
       for(let j=1;j<=totalpages;j++){
          %>
          
          <a class="text-black" style="text-decoration: none;" href="?page=<%=j%>"><button style="color: white; width: 3%;" class="btn btn-light"> <%= j %></button></a>
          <%
       }
      %>
  
  
      </div>
                
    
      <!-- Footer -->
      <footer style="background-color: rgb(65 62 62);" class="text-center text-lg-start text-muted  mt-0 pt-5">
        <!-- Section: Links  -->
        <section class="">
          <div class="container text-center text-md-start pt-4 pb-4">
            <!-- Grid row -->
            <div class="row mt-3">
              <!-- Grid column -->
              <div class="col-12 col-lg-3 col-sm-12 mb-2">
                <!-- Content -->
                <a href="#" target="_blank" class="text-white h2">
                  TREND HUB
                </a>
                <p class="mt-1 text-white">
                  © 2023 Copyright
                </p>
              </div>
              <!-- Grid column -->
      
              <!-- Grid column -->
              <div class="col-6 col-sm-4 col-lg-2">
                <!-- Links -->
                <h6 class="text-uppercase text-white fw-bold mb-2">
                  Store
                </h6>
                <ul class="list-unstyled mb-4">
                  <li><a class="text-white" href="/aboutus">About us</a></li>
                  <li><a class="text-white" href="#">Categories</a></li>
                  <li><a class="text-white" href="#">Blogs</a></li>
                </ul>
              </div>
              <!-- Grid column -->
      
              <!-- Grid column -->
              <div class="col-6 col-sm-4 col-lg-2">
                <!-- Links -->
                <h6 class="text-uppercase text-white fw-bold mb-2">
                  Information
                </h6>
                <ul class="list-unstyled mb-4">
                  <li><a class="text-white" href="#">Help center</a></li>
                  <li><a class="text-white" href="#">Money refund</a></li>
                  <li><a class="text-white" href="#">Shipping info</a></li>
            
                </ul>
              </div>
              <!-- Grid column -->
      
              <!-- Grid column -->
              <div class="col-6 col-sm-4 col-lg-2">
                <!-- Links -->
                <h6 class="text-uppercase text-white fw-bold mb-2">
                  Support
                </h6>
                <ul class="list-unstyled mb-4">
                 
                  <li><a class="text-white" href="#">My orders</a></li>
                </ul>
              </div>
              <!-- Grid column -->
      
              <!-- social meadias column -->

              <div class="col-6 col-sm-4 col-lg-2">
                <!-- Links -->
                <h6 class="text-uppercase text-center text-white fw-bold mb-4">
                  Keep in touch
                </h6>
                
                <ul class="list-unstyled mb-4  text-center">
                    <a href=""><i class="fab fa-facebook-f fa-2x ml-4" style="color: #3b5998;"></i></a>
                    <!-- Instagram -->
                    <a href=""><i class="fab fa-instagram fa-2x ml-4" style="color: #ac2bac;"></i></a>
                   <!-- Linkedin -->
                   <a href=""><i class="fab fa-linkedin-in fa-2x ml-4" style="color: #0082ca;"></i></a>
            
                </ul>
              </div>



          
              <!-- social medias column -->
            </div>
            <!-- Grid row -->
          </div>
        </section>
        <!-- Section: Links  -->
      
        <div class="">
          <div class="container">
            <div class="d-flex justify-content-between py-4 border-top">
              <!--- payment --->
              <div>
               
                <i class="fab fa-lg fa-cc-visa text-white"></i>
                <i class="fab fa-lg fa-cc-amex text-white"></i>
                <i class="fab fa-lg fa-cc-mastercard text-white"></i>
                <i class="fab fa-lg fa-cc-paypal text-white"></i>
              </div>
              <!--- payment --->
      
              <!--- language selector --->
              <div class="dropdown dropup ">
                <a class="dropdown-toggle text-white" href="#" id="Dropdown" role="button" data-mdb-toggle="dropdown" aria-expanded="false"> <i class="flag-united-kingdom flag m-0 me-1"></i>English </a>
      
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="Dropdown">
                  <li>
                    <a class="dropdown-item" href="#"><i class="flag-united-kingdom flag"></i>English <i class="fa fa-check text-success ms-2"></i></a>
                  </li>
                  <li>
                    <hr class="dropdown-divider" />
                  </li>
                  <li>
                    <a class="dropdown-item" href="#"><i class="flag-poland flag"></i>Polski</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="#"><i class="flag-china flag"></i>中文</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="#"><i class="flag-japan flag"></i>日本語</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="#"><i class="flag-germany flag"></i>Deutsch</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="#"><i class="flag-france flag"></i>Français</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="#"><i class="flag-spain flag"></i>Español</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="#"><i class="flag-russia flag"></i>Русский</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="#"><i class="flag-portugal flag"></i>Português</a>
                  </li>
                </ul>
              </div>
              <!--- language selector --->
            </div>
          </div>
        </div>
      </footer>
      <!-- Footer -->
  
   
    <script>
      function copyCode() {
          // Get the text field
          const codeInput = document.getElementById("codeInput");

          // Select the text field
          codeInput.select();
          codeInput.setSelectionRange(0, 99999); // For mobile devices

          // Copy the text inside the text field
          document.execCommand("copy");

          // Deselect the text field
          codeInput.setSelectionRange(0, 0);

          // Provide visual feedback (optional)
          alert("Code copied to clipboard: " + codeInput.value);
      }
  </script>
</body>
</html>