<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Order Dashboard</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="assets/imgs/theme/favicon.svg">
    <!-- Template CSS -->
    <link href="assets/css/main.css" rel="stylesheet" type="text/css" />
    
</head>

<body>
    <div class="screen-overlay"></div>
    <%- include("../layout/Adminbar.ejs")%>
    <main class="main-wrap">
        <header class="main-header navbar">
            <div class="col-search">
            
            </div>
            <div class="col-nav">
                <button class="btn btn-icon btn-mobile me-auto" data-trigger="#offcanvas_aside"> <i class="material-icons md-apps"></i> </button>
               


            </div>
        </header>
        <section class="content-main">
            <div class="content-header">
                <div>
                    <h2 class="content-title card-title">Order List</h2>
                 
                </div>
              
            </div>
            <div class="card mb-4">
                <header class="card-header">
                    <!-- <div class="row gx-3">
                        <div class="col-lg-4 col-md-6 me-auto">
                            <input type="text" placeholder="Search..." class="form-control">
                        </div>
                        <div class="col-lg-2 col-6 col-md-3">
                            <select class="form-select">
                                <option>Status</option>
                                <option>Active</option>
                                <option>Disabled</option>
                                <option>Show all</option>
                            </select>
                        </div>
                    
                    </div> -->
                </header> <!-- card-header end// -->
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                
                                  <th scope="col">ProductsImages</th>
                                  <th scope="col">Products</th>
                                  <th scope="col">Price</th>
                                  <th scope="col">Quantity</th>
                                  <th scope="col">Sub-Total</th>
                                  <th scope="col">CancelOrder</th>
                                  <th scope="col">Status</th>
                                  <th scope="col">Date</th>
                                  <th scope="col">change Status</th>
                                  
                                </tr>
                              </thead>
                              <tbody>
                                  
         <%
  
           if(userCart.length>0){
  
       
         userCart.forEach((item,i)=>{
             %>
  
             <%item.products.forEach((value)=>{%>
              
         <tr>
  
          <td> <img src="/productImages/<%=value.product_id?.images[1]%>" width="50px" height="50px" alt="Blue Jeans Jacket" /></td>
          <td><%=value.product_id.productname%></td>
          <td><%=value.price%></td>
          <td><%=value.qty%></td>
          <td><%=value.totalPrice%></td>
           <input type="hidden" value="<%=item._id%>" >
          <%if(value.status!=="canceled"){%>
         
            
            <td><a href="/admin/orderstatus?id=<%=value._id %>&&orderid=<%=item._id%>"><strong>Cancel</strong></a></td>
            <%}else{
              %>
              <td><p style="color: red;" ><strong>Canceled</strong></p></td>
              <%
            }%>
           <td  ><h6 style="color:orange"><%=value.status%></h6></td>
           <td  ><h8><%=item.createdAt.toDateString()%></h8></td>
    
          
          <!-- Example single danger button -->
            <td> <ul class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <button  style="color:white; background-color: black; border-radius: 5px;" >Change status</button>
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="/admin/confirmed?id=<%=value._id %>&&orderid=<%=item._id%>">Confirmed</a></li>
                <li><a class="dropdown-item" href="/admin/outdelivery?id=<%=value._id %>&&orderid=<%=item._id%>">out of delevery</a></li>
                <li><a class="dropdown-item" href="/admin/returned?id=<%=value._id%>&&orderid=<%=item._id%>">returned</a></li>
                <li><a class="dropdown-item" href="/admin/delivered?orderid=<%=item._id%>&&productid=<%=value._id%>">Delivered</a></li>
                <li><a class="dropdown-item" href="/admin/shipped?orderid=<%=item._id%>&&productid=<%=value._id%>">Shipped</a></li>
               
              </ul>
            </ul></td>
        </tr>
  
  
              <%})
  
              
              
              
              %>
               
           
            
           
   
      
  
  
  
            
             <%
         })
  
        }else{
          %>
         <td><h3 style="color: red;">No orders</h3></td>
          
          <%
        }
      
         
         %>
  
       
  
  
  
  
  
  
       
  
        
    
      
        
                              </tbody>
                          
                        </table>
                    </div> <!-- table-responsive //end -->
                </div> <!-- card-body end// -->
            </div> <!-- card end// -->

            
    
            <div class="pagination-area mt-15 mb-50">
                <nav aria-label="Page navigation example">
                    <div class="text-center">
     
                        <%
                     for(let j=1;j<=totalpages;j++){
                        %>
                        
                        <a class="text-black" style="text-decoration: none;" href="?page=<%=j%>"><button class="btn btn-light"> <%= j %></button></a>
                        <%
                     }
                    %>
                
                
                    </div>
                 
                </nav>
            </div>
        </section> <!-- content-main end// -->
        <footer class="main-footer font-xs">
            <div class="row pb-30 pt-15">
                <div class="col-sm-6">
                    <script>
                    document.write(new Date().getFullYear())
                    </script> Â©, Evara - HTML Ecommerce Template .
                </div>
                <div class="col-sm-6">
                    <div class="text-sm-end">
                        All rights reserved
                    </div>
                </div>
            </div>
        </footer>
    </main>
    <script src="assets/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="assets/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="assets/js/vendors/select2.min.js"></script>
    <script src="assets/js/vendors/perfect-scrollbar.js"></script>
    <script src="assets/js/vendors/jquery.fullscreen.min.js"></script>
    <!-- Main Script -->
    <script src="assets/js/main.js" type="text/javascript"></script>
</body>

</html>